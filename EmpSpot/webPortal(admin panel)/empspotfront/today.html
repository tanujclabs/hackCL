
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />

        <title>DataTables Bootstrap 3 example</title>

        <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="css/dataTables.bootstrap.css">

        <script type="text/javascript" src="//code.jquery.com/jquery-1.10.2.min.js"></script>
        <script type="text/javascript" src="//cdn.datatables.net/1.10-dev/js/jquery.dataTables.min.js"></script>
        <script type="text/javascript" src="//cdn.datatables.net/plug-ins/e9421181788/integration/bootstrap/3/dataTables.bootstrap.js"></script>
        <script src="js/jquery.maskedinput.js" type="text/javascript"></script>
        <style>
            td{
                font-size: 15px;
            }
            img{
                width:90px;
                height:90px;
            }

            @font-face
            {
                font-family:track;
                src: url(font/Track.ttf);
            }


            body{
                background-color:#EEEFF5;
            }
            .form-inline .form-control {


                width:750px;
                height:43px;
                margin-bottom: 10px;

            }
            #new_user_form{
                width: 750px;
                margin: 0 auto;

            }
            .menu_tab{
                float:left;
                background:#fff;
                width: 200px;
                height: 40px;
            }
            .menu_tab a{
                font-family:track;
                font-size:22px;
            }

            .glyphicon-user:before {

                font-size: 98px;
            }
            .panel{
                width: 250px;
                height: 75px;
                border:0px;
            }
            .symbol{
                height: 75px;
                width: 75px;
                text-align: center;
                padding-top: 16px;
                font-size: 36px;
                background:#49BDF0;
            }
            .value{

                font-family: track;
                font-size: 18px;
                color: #49BDF0;
                padding-top: 26px;
                padding-left: 20px;

            }
            #example_wrapper{

                width: 100%;
            }

        </style>
    </head>
    <body>
        <div style="margin-top:6%;">
            <div style="float:left">
                <div>
                    <a href="http://67.202.34.113/nodeTraining/empspotfront/newuser.php">
                        <section class="panel">
                            <div class="symbol terques" style="float:left">
                                <span class="glyphicon glyphicon-plus"></span>
                            </div>
                            <div class="value" style="float:left">
                                New Entry
                            </div>
                            <div style="clear:both"></div>
                        </section>
                    </a>
                </div>

                <div>
                    <a href="#">
                        <section class="panel">
                            <div class="symbol terques" style="float:left">
                                <span class="glyphicon glyphicon-time"></span>
                            </div>
                            <div class="value" style="float:left">
                                Today
                            </div>
                            <div style="clear:both"></div>
                        </section>
                    </a>
                </div>
                <div>
                    <a href="http://67.202.34.113/nodeTraining/empspotfront/approval.html">
                        <section class="panel">
                            <div class="symbol terques" style="float:left">
                                <span class="glyphicon glyphicon-th"></span>
                            </div>
                            <div class="value" style="float:left">
                                Approve
                            </div>
                            <div style="clear:both"></div>
                        </section>
                </div>
                </a>
                <div style="clear:both"></div>
            </div>



            <div style="float:left;margin-left:10%">
                <div>
                    <input type="button" value="Done" id="all_done" class="btn btn-default" style="width:100%;margin-bottom:5%;background: #49BDF0;color:#fff;font-family: track;font-size: 17px;padding-top: 12px;">
                </div>
                <div>
                    <form>
                        <input type="text" id="put_date">
                        <input type="button" value="Go" id="date_change">
                    </form>
                </div>
                <table id="example" class="display" cellspacing="0" width="100%">
                </table>

            </div>
        </div>
        <script type="text/javascript">

            // For demo to fit into DataTables site builder...
            $('#example')
                    .removeClass('display')
                    .addClass('table table-striped table-bordered');</script>




        <script type="text/javascript">


            $(document).ready(function() {
                $("#put_date").mask("9999-99-99");



                var today_date = new Date();



                function formattedDate(date) {
                    var d = new Date(date || Date.now()),
                            month = '' + (d.getMonth() + 1),
                            day = '' + d.getDate(),
                            year = d.getFullYear();

                    if (month.length < 2)
                        month = '0' + month;
                    if (day.length < 2)
                        day = '0' + day;

                    return [year, month, day].join('-');
                }


                var date_format = formattedDate(today_date);
                console.log(date_format);

                var str = "";
                $.ajax({
                    type: "Post",
                    url: "http://67.202.34.113:2000/view_today_attendance",
                    dataType: "JSON",
                    async: false,
                    data: {date: date_format},
                    success: function(data) {
                        console.log(data);
                        str = "<thead>";
                        str += "                                <tr>";
                        str += "                                      <th>Name</th>";
                        str += "                                      <th>In</th>";
                        str += "                                      <th>out</th>";
                        str += "                                      <th>Present/Absent";
                        str += "                                  </tr>";
                        str += "</thead>"
                        str += "<tbody> ";
                        for (var i = 0; i < data['data'].length; i++) {


                            str += "                               <tr>";
                            str += "                                     <td><div style='float:left'><img src='" + data['data'][i]['user_image'] + "' style='width:90px;height:90px;'></div><div style='float:left;margin-left:2%;font-size;18px;'>" + data['data'][i]['user_name'] + "<br />" + data['data'][i]['email_id'] + "<br />" + data['data'][i]['phone'] + "</div><div style='clear:both'></div></td>";
                            str += "                                     <td><div style='float:left'><img src='" + data['data'][i]['clicked_image_in_time'] + "' style='width:90px;height:90px;'></div><div style='float:left;margin-left:2%;font-size;18px;'>" + data['data'][i]['in_time'] + "</div><div style='clear:both'></div></td>";
                            str += "                                     <td><div style='float:left'><img src='" + data['data'][i]['clicked_image_out_time'] + "' style='width:90px;height:90px;'></div><div style='float:left;margin-left:2%;font-size;18px;'>" + data['data'][i]['out_time'] + "</div><div style='clear:both'></div></td>";
                            str += "                                     <td><input type='checkbox' value='aaa' class='flag_" + data['data'][i]['present_absent_flag'] + "' id='id_" + data['data'][i]['attendance_id'] + "'></td>";
                            str += "                                 </tr>";


                        }
                        str += "</tbody> ";

                        $('#example').html(str);

                        $('#example').find('input:checkbox').each(function() {

                            var check_val = $(this).attr('class');
                            var check_val = check_val.slice(5);
                            console.log(check_val);
                            if (check_val == "1") {
                                console.log("hello");
                                $(this).prop('checked', true);
                            }
                        });


                    },
                    error: function(error) {
                        console.log("gjg");
                    }

                });



                $('#date_change').click(function() {
                    var today_date = $("#put_date").val();
                    console.log(today_date);
                    $('#example').html("");


                    var str = "";
                    $.ajax({
                        type: "Post",
                        url: "http://67.202.34.113:2000/view_today_attendance",
                        dataType: "JSON",
                        async: false,
                        data: {date: date_format},
                        success: function(data) {
                            console.log(data);
                            str = "<thead>";
                            str += "                                <tr>";
                            str += "                                      <th>Name</th>";
                            str += "                                      <th>In</th>";
                            str += "                                      <th>out</th>";
                            str += "                                      <th>Present/Absent";
                            str += "                                  </tr>";
                            str += "</thead>"
                            str += "<tbody> ";
                            for (var i = 0; i < data['data'].length; i++) {


                                str += "                               <tr>";
                                str += "                                     <td><div style='float:left'><img src='" + data['data'][i]['user_image'] + "' style='width:90px;height:90px;'></div><div style='float:left;margin-left:2%;font-size;18px;'>" + data['data'][i]['user_name'] + "<br />" + data['data'][i]['email_id'] + "<br />" + data['data'][i]['phone'] + "</div><div style='clear:both'></div></td>";
                                str += "                                     <td><div style='float:left'><img src='" + data['data'][i]['clicked_image_in_time'] + "' style='width:90px;height:90px;'></div><div style='float:left;margin-left:2%;font-size;18px;'>" + data['data'][i]['in_time'] + "</div><div style='clear:both'></div></td>";
                                str += "                                     <td><div style='float:left'><img src='" + data['data'][i]['clicked_image_out_time'] + "' style='width:90px;height:90px;'></div><div style='float:left;margin-left:2%;font-size;18px;'>" + data['data'][i]['out_time'] + "</div><div style='clear:both'></div></td>";
                                str += "                                     <td><input type='checkbox' value='aaa' class='flag_" + data['data'][i]['present_absent_flag'] + "' id='id_" + data['data'][i]['attendance_id'] + "'></td>";
                                str += "                                 </tr>";


                            }
                            str += "</tbody> ";

                            $('#example').html(str);

                            $('#example').find('input:checkbox').each(function() {

                                var check_val = $(this).attr('class');
                                var check_val = check_val.slice(5);
                                console.log(check_val);
                                if (check_val == "1") {
                                    console.log("hello");
                                    $(this).prop('checked', true);
                                }
                            });


                        },
                        error: function(error) {
                            console.log("gjg");
                        }

                    });
                });


                $('#all_done').click(function() {

                    $('#example').find('input:checkbox:not(:checked)').each(function() {
                        //this is the current checkbox
                        //                        alert('Hello');
                        var att_id = $(this).attr('id');
                        var res = att_id.slice(3);
                        console.log(res);


                        $.ajax({
                            type: "Post",
                            url: "http://67.202.34.113:2000/edit_present_absent_flag_web_panel",
                            dataType: "JSON",
                            async: false,
                            data: {attendance_ids: res, present_absent_flag_ids: 0},
                            success: function(data) {
                                console.log(data);
                            },
                            error: function(error) {
                                console.log("gjg");
                            }

                        });



                    });
                    //                    $('input:checkbox:not(:checked)');



                    //                    allusers = $.map($(".mycheckbox"), function(n, i) {
                    //                        return n.id;
                    //                    });
                    //
                    //
                    //                    offeridsstring = "";
                    //
                    //                    j = 0;
                    //                    for (i = 0; i < allusers.length; i++)
                    //                    {
                    //                        valueCheck = $('#' + allusers[i]).is(':checked');
                    //                        if (valueCheck)
                    //                        {
                    //                            checkedoffersid[j] = $("#" + allusers[i]).val();
                    //                            j++;
                    //                        }
                    //                    }
                    //
                    //                    for (i = 0; i < ((checkedoffersid.length) - 1); i++)
                    //                    {
                    //                        offeridsstring += checkedoffersid[i] + ",";
                    //                    }
                    //                    offeridsstring += checkedoffersid[i];


                });
                $('#example').dataTable();
            });

        </script>


    </body>
</html>